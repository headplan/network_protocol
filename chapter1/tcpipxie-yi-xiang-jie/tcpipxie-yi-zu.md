# TCP/IP协议族

TCP/IP协议族 , 是一个分层多协议的通信体系 .

#### TCP/IP协议族体系结构以及主要协议

TCP/IP协议族是一个四层协议系统 , 自底而上分别是数据链路层 , 网络层 , 传输层和应用层 . 每一层完成不同的功能 , 且通过若干协议来实现 , 上层协议使用下层协议提供的服务 .

![](/assets/tcpip.png)**数据链路层**

数据链路层实现了网卡接口的网络驱动程序 , 用来处理数据在物理媒介上的传输\(例 , 以太网,令牌环等\) . 网络驱动程序隐藏了不同的物理网络的特性 , 给上层协议提供了一个统一的接口 .

数据链路层常用的协议 :

* ARP协议 - 地址解析协议\(Address Resolution Protocol\)
* RARP协议 - 逆\(反向\)地址解析协议\(Reverse Address Resolution Protocol\)

她们实现了IP地址和机器物理地址之间的相互转换 .

> 机器物理地址 - 通常是指MAC地址 , 以太网 , 令牌环和802.11无线网络都是用MAC地址

工作流程 :

网络层使用IP地址寻找一台机器 , 而数据链路层则使用物理地址寻找一台机器 . 所以网络层必须先将目标机器的IP地址转化成其物理地址 , 才能使用数据链路层提供的服务 , 这就是ARP协议的用途 . 而RARP协议仅用于一些无盘的网络工作站 , 因为缺乏存储设备 , 这类无盘工作站无法记录自己的IP地址 , 但是他们可以使用物理网卡上的物理地址来向服务器或者服务管理软件查询自己的IP地址 . 所以通常情况下这些物理管理者会存有这个网络上所有机器的物理地址到IP地址的映射 .

**网络层**

网络层实现数据包的选路和转发 . 

WAN通常使用众多分级的路由器来连接分散的主机或LAN , 因此通信的两台主机一般不是直接相连的 , 而是通过多个中间节点 , 也就是路由器连接的 . 

> WAN - 广域网\(Wide Area Network\) , 也叫远程网络
>
> LAN - 局域网

网络层的任务就是选定这些中间节点 , 以确定两台主机之间的通信路径 . 同时 , 网络层对上层协议隐藏了网络拓扑连接的细节 , 使得在传输层和网络应用层的通信看起来是双方直接相连的 . 

> IP协议 - 因特网协议\(Internet Protocol\)
>
> ICMP协议 - 因特网控制报文协议\(Internet Control Message Protocol\)

工作流程 : 

网络层最核心的协议是IP协议 . IP协议根据数据包的目的IP地址来决定如何投递 . 如果数据包不能直接发送给目标主机 , 那么IP协议就为它寻找一个合适的吓一跳\(next hop\)路由器 , 并将数据包交付给该路由器来转发 . 多次重复这一过程 , 让数据包最终达到目标主机 , 或者由于发送失败而被丢弃 , 由此可见 , IP协议是使用逐跳\(hop by hop\)的方式确定通信的路径 . 

传输层

应用层

